extend type Query {
    """
    Returns the local directory at the given directory or comma-separated list of directories.
    This is intended to be used by Cody App.
    """
    localDirectories(paths: [String!]!): LocalDirectories!

    """
    Lists external services that are configured for Cody App local code repositories. This is intended to be used
    by Cody App.
    """
    localExternalServices: [LocalExternalService!]!

    """
    Allows Admin users to list the progress of embeddings for 1 or more repos. This is intended to be used only by the Cody App
    """
    embeddingsSetupProgress(repoNames: [String!]): EmbeddingsSetupProgress!
}

"""
EmbeddingsSetupProgress represents the overall status of embeddings creation. This is an API specific to Cody App.
"""
type EmbeddingsSetupProgress {
    """
    The overall percentage of setting up embeddings with 0 meaning no progress not started and 100 means the job is complete.
    """
    overallPercentComplete: Int!

    """
    The repository that is currently being processed
    """
    currentRepository: String

    """
    The number of files processed for the current repository
    """
    currentRepositoryFilesProcessed: Int

    """
    The total number of files to process for the current repository
    """
    currentRepositoryTotalFilesToProcess: Int

    """
    Indicates that at least 1 repository has successfully completed
    """
    oneRepositoryReady: Boolean!
}

"""
LocalDirectories represents a list of directories on the host machine. This is an API
specific to Cody App.
"""
type LocalDirectories {
    """
    A list of absolute paths to local directories that exist.
    If LocalDirectories was created via picker these are the paths picked.
    """
    paths: [String!]!

    """
    Repositories is the recursive list of repositories found under path.


    Note: This field is blocking to compute. It uses heuristics to return a
    best-effort list in 5s.
    """
    repositories: [LocalRepository!]!
    # Question: Would it be better to be a connection with pagination? There
    # are serious limitations to this due to it not being a DB query, which is
    # why I chose a list.
}

"""
LocalRepository represents a repository found recursively from a directory on
the host machine. This is an API specific to Cody App.
"""
type LocalRepository {
    """
    The name of the local repository. This is usually the relative path from the
    root this repository was found.
    """
    name: String!

    """
    The absolute path to a local repository.
    """
    path: String!
}

"""
An external service that is configured for Cody App local code repositories.
"""
type LocalExternalService {
    """
    The external service's unique ID.
    """
    id: ID!

    """
    The external service's path to local directory.
    """
    path: String!

    """
    If this is true then the external service is intended to be managed by Cody App services and not by the user.
    """
    autogenerated: Boolean!

    """
    Repositories is the recursive list of repositories found under path.
    """
    repositories: [LocalRepository!]!
}

extend type Mutation {
    """
    Experimental: Waits for a repos to be cloned and then schedules a job to create an embeddings
    If force is set to true, then the repo will be re-embedded even if there's already an up-to-date embeddings index.
    This is an API specific to Cody App.
    """
    setupNewAppRepositoriesForEmbedding(repoNames: [String!]!): EmptyResponse!

    """
    Create one or more local repository services for the provided paths. A path may
    also point to a directory containing repositories.
    """
    addLocalRepositories(paths: [String!]!): EmptyResponse!
}
