import { ICursorPositionChangedEvent } from 'vs/editor/common/editorCommon';
import { IEditor as IBaseEditor, IEditorInput, ITextEditorOptions, IResourceInput } from 'vs/platform/editor/common/editor';
import { IWorkbenchEditorService } from 'vs/workbench/services/editor/common/editorService';
import { IHistoryService } from 'vs/workbench/services/history/common/history';
import { FileChangesEvent, IFileService } from 'vs/platform/files/common/files';
import { Selection } from 'vs/editor/common/core/selection';
import { IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';
import { IDisposable } from 'vs/base/common/lifecycle';
import { IStorageService } from 'vs/platform/storage/common/storage';
import { ILifecycleService } from 'vs/platform/lifecycle/common/lifecycle';
import { IConfigurationService } from 'vs/platform/configuration/common/configuration';
import { IEditorGroupService } from 'vs/workbench/services/group/common/groupService';
import { IWindowService } from 'vs/platform/windows/common/windows';
import { ParsedExpression } from 'vs/base/common/glob';
/**
 * Stores the selection & view state of an editor and allows to compare it to other selection states.
 */
export declare class EditorState {
    private _editorInput;
    private _selection;
    private static EDITOR_SELECTION_THRESHOLD;
    constructor(_editorInput: IEditorInput, _selection: Selection);
    readonly editorInput: IEditorInput;
    readonly selection: Selection;
    justifiesNewPushState(other: EditorState, event?: ICursorPositionChangedEvent): boolean;
}
export declare abstract class BaseHistoryService {
    protected editorGroupService: IEditorGroupService;
    protected editorService: IWorkbenchEditorService;
    protected contextService: IWorkspaceContextService;
    private configurationService;
    protected toUnbind: IDisposable[];
    private activeEditorListeners;
    protected excludes: ParsedExpression;
    private lastKnownExcludesConfig;
    constructor(editorGroupService: IEditorGroupService, editorService: IWorkbenchEditorService, contextService: IWorkspaceContextService, configurationService: IConfigurationService);
    private onConfigurationChanged(update?);
    private onEditorsChanged();
    protected abstract handleExcludesChange(): void;
    protected abstract handleEditorSelectionChangeEvent(editor?: IBaseEditor, event?: ICursorPositionChangedEvent): void;
    protected abstract handleActiveEditorChange(editor?: IBaseEditor): void;
    dispose(): void;
}
export declare class HistoryService extends BaseHistoryService implements IHistoryService {
    private storageService;
    private lifecycleService;
    private fileService;
    private windowService;
    _serviceBrand: any;
    private static STORAGE_KEY;
    private static MAX_HISTORY_ITEMS;
    private static MAX_STACK_ITEMS;
    private static MAX_RECENTLY_CLOSED_EDITORS;
    private static MERGE_EVENT_CHANGES_THRESHOLD;
    private stack;
    private index;
    private navigatingInStack;
    private currentFileEditorState;
    private history;
    private recentlyClosedFiles;
    private loaded;
    private registry;
    constructor(editorService: IWorkbenchEditorService, editorGroupService: IEditorGroupService, contextService: IWorkspaceContextService, storageService: IStorageService, configurationService: IConfigurationService, lifecycleService: ILifecycleService, fileService: IFileService, windowService: IWindowService);
    private registerListeners();
    private onFileChanges(e);
    private onEditorClosed(event);
    reopenLastClosedEditor(): void;
    forward(): void;
    back(): void;
    clear(): void;
    private navigate();
    protected handleEditorSelectionChangeEvent(editor?: IBaseEditor, event?: ICursorPositionChangedEvent): void;
    protected handleActiveEditorChange(editor?: IBaseEditor): void;
    private handleEditorEventInHistory(editor?);
    private include(input);
    protected handleExcludesChange(): void;
    remove(input: IEditorInput | IResourceInput): void;
    remove(input: FileChangesEvent): void;
    private removeExcludedFromHistory();
    private removeFromHistory(arg1);
    private handleEditorEventInStack(editor, event?);
    private handleTextEditorEvent(editor, editorControl, event?);
    private handleNonTextEditorEvent(editor);
    add(input: IEditorInput, options?: ITextEditorOptions, fromEvent?: boolean): void;
    private addToStack(input, options?, fromEvent?);
    private preferResourceInput(input);
    private sameOptions(optionsA?, optionsB?);
    private removeFromStack(arg1);
    private removeFromRecentlyClosedFiles(arg1);
    private removeFromRecentlyOpen(arg1);
    private isFileOpened(resource, group);
    private matches(arg1, inputB);
    private matchesFile(resource, arg2);
    getHistory(): (IEditorInput | IResourceInput)[];
    private ensureHistoryLoaded();
    private save();
    private loadHistory();
}
